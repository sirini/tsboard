<template>
  <v-app class="app">
    <home-header></home-header>
    <v-layout class="layout">
      <side-drawer></side-drawer>
      <v-main>
        <v-container class="wrap">
          <v-row class="mt-6">
            <v-col>
              <v-card rounded="xl" class="box">
                <v-card-title class="title">TSBOARDëŠ” ë¬´ì—‡ì¸ê°€ìš”?</v-card-title>
                <v-divider></v-divider>
                <v-card-text class="pa-0 list">
                  <v-list>
                    <v-list-item prepend-icon="mdi-language-typescript">
                      TSBOARDëŠ” <strong>íƒ€ì…ìŠ¤í¬ë¦½íŠ¸</strong>ë¡œ ì‘ì„±ëœ ì˜¤í”ˆì†ŒìŠ¤ ê²Œì‹œíŒì…ë‹ˆë‹¤. (MIT
                      license)
                    </v-list-item>
                    <v-divider></v-divider>
                    <v-list-item prepend-icon="mdi-vuejs">
                      í”„ë¡ íŠ¸ì—”ë“œëŠ” Vue 3 / Vuetify / Vue Router / Pinia ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
                    </v-list-item>
                    <v-divider></v-divider>
                    <v-list-item prepend-icon="mdi-database-sync-outline">
                      ë°±ì—”ë“œëŠ” Bun / ElysiaJS / MySQL(MariaDB) ë¡œ êµ¬ì„±ë˜ë©°, ì›¹ì„œë²„ëŠ” Nginxë¥¼
                      ê¶Œì¥í•©ë‹ˆë‹¤.
                    </v-list-item>
                  </v-list>
                </v-card-text>
              </v-card>
            </v-col>
            <v-col>
              <v-card rounded="xl" class="box">
                <v-card-title class="title">ì™œ ê°œë°œí–ˆë‚˜ìš”?</v-card-title>
                <v-divider></v-divider>
                <v-card-text class="pa-0 list">
                  <v-list>
                    <v-list-item>
                      íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ ì–¸ì–´ê°€ ë§ˆìŒì— ë“¤ì–´ì„œ ì´ ì–¸ì–´ë¡œ í’€ìŠ¤íƒ ê²Œì‹œíŒì„ ë§Œë“¤ì–´ë³´ê³ ì
                      ì‹œì‘í•œ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.
                    </v-list-item>
                    <v-divider></v-divider>
                    <v-list-item>
                      ì¤‘ì†Œí˜• ì»¤ë®¤ë‹ˆí‹° ì‚¬ì´íŠ¸ ì œì‘ì—ë„ í™œìš©í•˜ê³ , ì¶”í›„ ë¸”ë¡œê·¸ë‚˜ ì‡¼í•‘ëª°ê¹Œì§€ ê¸°ëŠ¥ì„
                      í™•ì¥í•´ ë³´ë ¤ê³  ì‹œì‘í–ˆìŠµë‹ˆë‹¤.
                    </v-list-item>
                    <v-divider></v-divider>
                    <v-list-item><strong>ê·¸ëƒ¥ ì¬ë°Œì–´ì„œ</strong> ë§Œë“¤ì—ˆì–´ìš”. ğŸ˜™</v-list-item>
                  </v-list>
                </v-card-text>
              </v-card>
            </v-col>
            <v-col>
              <v-card rounded="xl" class="box">
                <v-card-title class="title">ì–´ë””ì„œ ë°›ë‚˜ìš”?</v-card-title>
                <v-divider></v-divider>
                <v-card-text class="pa-0 list">
                  <v-list>
                    <v-list-item
                      >TSBOARDëŠ” ê¹ƒí—ˆë¸Œ(Github)ë¥¼ í†µí•´ ì†ŒìŠ¤ì½”ë“œ ì „ì²´ë¥¼ ë‚´ë ¤ë°›ìœ¼ì‹¤ ìˆ˜ ìˆìœ¼ë©°,
                      ìš´ì˜í•˜ì‹¤ ì‚¬ì´íŠ¸ì˜ ëª©ì ì— ë§ê²Œ ìˆ˜ì •í•˜ì—¬ í™œìš©í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</v-list-item
                    >
                    <v-list-item>
                      ì„¤ì¹˜ ì•ˆë‚´ëŠ” Github í˜ì´ì§€ì—ì„œ í™•ì¸ í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ì¤€ë¹„ì¤‘)
                    </v-list-item>
                  </v-list>
                </v-card-text>
                <v-divider class="mt-4"></v-divider>
                <v-card-actions>
                  <v-spacer></v-spacer>
                  <v-btn prepend-icon="mdi-download" append-icon="mdi-github" color="blue-grey"
                    >Download from Github</v-btn
                  >
                  <v-spacer></v-spacer>
                </v-card-actions>
              </v-card>
            </v-col>
          </v-row>

          <v-row class="mb-12">
            <v-col v-for="(post, index) in home.latestPosts" :key="index" cols="4">
              <v-card
                rounded="xl"
                class="box"
                @click="
                  util.go(
                    post.type === BOARD_TYPE.BOARD ? 'boardView' : 'galleryOpen',
                    post.id,
                    post.uid,
                  )
                "
              >
                <v-img
                  v-if="post.cover.length > 0"
                  height="200"
                  cover
                  :src="PREFIX + post.cover"
                ></v-img>
                <v-card-title class="title">
                  <v-chip size="small" class="mr-2" label color="blue-grey">{{
                    util.unescape(post.category)
                  }}</v-chip
                  >{{ util.unescape(post.title) }}</v-card-title
                >
                <v-divider></v-divider>
                <v-card-text
                  v-if="post.cover.length < 1"
                  class="content"
                  v-html="post.content"
                ></v-card-text>
                <v-divider v-if="post.cover.length < 1"></v-divider>
                <v-card-actions class="pl-3 pr-3">
                  <v-chip
                    prepend-icon="mdi-eye-outline"
                    append-icon="mdi-heart-outline"
                    color="blue-grey"
                    size="small"
                    >{{ util.num(post.hit) }}
                    <v-divider vertical class="ml-3 mr-3"></v-divider>
                    {{ util.num(post.like) }}
                  </v-chip>
                  <v-spacer></v-spacer>
                  <v-chip
                    :prepend-avatar="
                      PREFIX +
                      (post.writer.profile.length > 0 ? post.writer.profile : '/no-profile.svg')
                    "
                    size="small"
                    color="blue-grey"
                    >{{ util.unescape(post.writer.name) }}</v-chip
                  >
                </v-card-actions>
              </v-card>
            </v-col>
            <v-col cols="4">
              <v-card rounded="xl" class="box" :color="home.color.header">
                <v-card-title class="title load">ì´ì „ ê²Œì‹œê¸€ ë¶ˆëŸ¬ì˜¤ê¸°</v-card-title>
                <v-card-text class="text-center mt-6">
                  <v-icon size="150" @click="home.loadLatestPosts">mdi-restore</v-icon>
                </v-card-text>
              </v-card>
            </v-col>
          </v-row>
        </v-container>
        <home-footer></home-footer>
      </v-main>
    </v-layout>
  </v-app>
</template>

<script setup lang="ts">
import { onMounted } from "vue"
import { useHomeStore } from "../../store/home"
import { useUtilStore } from "../../store/util"
import HomeHeader from "./HomeHeader.vue"
import HomeFooter from "./HomeFooter.vue"
import SideDrawer from "./SideDrawer.vue"
import { BOARD_TYPE } from "../../interface/board"

const home = useHomeStore()
const util = useUtilStore()
const PREFIX = process.env.PREFIX || ""

onMounted(() => home.loadLatestPosts())
</script>

<style scoped>
.app {
  background-color: #eceff1;
}
.wrap {
  min-height: calc(100vh - 118px);
}
.layout {
  margin-top: 64px;
}
.box {
  height: 300px;
  font-size: 1em;
}
.box .title {
  font-size: 1em;
  color: #37474f;
  height: 50px;
  font-weight: bold;
  overflow: hidden;
}
.box .load {
  color: white;
}
.box .list {
  line-height: 1.8em;
  font-size: 1em;
  color: #263238;
}
.box .content {
  height: 199px;
  overflow: hidden;
}
</style>
